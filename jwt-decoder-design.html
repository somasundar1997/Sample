<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Token Decoder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            color: #bdc3c7;
            font-size: 0.9em;
        }

        .content {
            padding: 30px;
        }

        .input-section {
            margin-bottom: 30px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-copy {
            background: #27ae60;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
        }

        .btn-copy:hover {
            background: #229954;
        }

        .output-section {
            display: none;
        }

        .output-section.active {
            display: block;
        }

        .section-title {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .token-parts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .token-part {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .token-part h3 {
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .token-part pre {
            background: white;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
        }

        .error {
            background: #ffe6e6;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            border-radius: 5px;
            color: #c0392b;
            margin-top: 15px;
        }

        .success {
            background: #e8f8f5;
            border-left: 4px solid #27ae60;
            padding: 15px;
            border-radius: 5px;
            color: #229954;
            margin-top: 15px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .info-box h4 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #455a64;
        }

        .info-box li {
            margin: 5px 0;
        }

        .claim-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .claim-table th,
        .claim-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .claim-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .claim-table tr:hover {
            background: #f5f5f5;
        }

        .claim-key {
            font-weight: 600;
            color: #667eea;
            font-family: 'Courier New', monospace;
        }

        .claim-value {
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }

        @media (max-width: 768px) {
            .token-parts {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê JWT Token Decoder</h1>
            <p>Decode and inspect JSON Web Tokens (JWT) - All processing happens in your browser</p>
        </div>

        <div class="content">
            <div class="info-box">
                <h4>‚ÑπÔ∏è About JWT Tokens</h4>
                <ul>
                    <li>JWT tokens consist of three parts: Header, Payload, and Signature</li>
                    <li>This tool decodes the Header and Payload (claims) from your JWT token</li>
                    <li>All decoding happens locally in your browser - no data is sent to any server</li>
                    <li>This tool does NOT verify the signature - it only decodes the token</li>
                </ul>
            </div>

            <div class="input-section">
                <label for="jwtInput">Paste your JWT Token:</label>
                <textarea 
                    id="jwtInput" 
                    placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
                ></textarea>
                <div class="button-group">
                    <button class="btn-primary" onclick="decodeToken()">üîì Decode Token</button>
                    <button class="btn-secondary" onclick="clearAll()">üóëÔ∏è Clear</button>
                </div>
                <div id="errorMessage"></div>
            </div>

            <div class="output-section" id="outputSection">
                <h2 class="section-title">Decoded Payload</h2>
                <div id="claimsTable"></div>
            </div>
        </div>
    </div>

    <script>
        function base64UrlDecode(str) {
            // Replace Base64URL characters with Base64 characters
            let base64 = str.replace(/-/g, '+').replace(/_/g, '/');
            
            // Pad with '=' to make the length a multiple of 4
            while (base64.length % 4) {
                base64 += '=';
            }
            
            // Decode Base64
            try {
                const decoded = atob(base64);
                // Convert to UTF-8
                return decodeURIComponent(escape(decoded));
            } catch (e) {
                throw new Error('Invalid Base64 encoding');
            }
        }

        function formatJSON(obj) {
            return JSON.stringify(obj, null, 2);
        }

        function formatTimestamp(timestamp) {
            if (typeof timestamp === 'number') {
                const date = new Date(timestamp * 1000);
                return date.toISOString() + ' (' + date.toLocaleString() + ')';
            }
            return timestamp;
        }

        function createClaimsTable(payload) {
            const commonClaims = {
                'iss': 'Issuer',
                'sub': 'Subject',
                'aud': 'Audience',
                'exp': 'Expiration Time',
                'nbf': 'Not Before',
                'iat': 'Issued At',
                'jti': 'JWT ID'
            };

            let html = '<h3 class="section-title" style="margin-top: 20px;">üìã Claims Details</h3>';
            html += '<table class="claim-table">';
            html += '<thead><tr><th>Claim</th><th>Description</th><th>Value</th></tr></thead>';
            html += '<tbody>';

            for (const [key, value] of Object.entries(payload)) {
                const description = commonClaims[key] || 'Custom Claim';
                let displayValue = value;

                // Format timestamps
                if (['exp', 'nbf', 'iat'].includes(key) && typeof value === 'number') {
                    displayValue = formatTimestamp(value);
                }
                // Format arrays and objects
                else if (typeof value === 'object') {
                    displayValue = JSON.stringify(value, null, 2);
                }

                html += `<tr>
                    <td class="claim-key">${key}</td>
                    <td>${description}</td>
                    <td class="claim-value">${displayValue}</td>
                </tr>`;
            }

            html += '</tbody></table>';
            return html;
        }

        function decodeToken() {
            const token = document.getElementById('jwtInput').value.trim();
            const errorDiv = document.getElementById('errorMessage');
            const outputSection = document.getElementById('outputSection');

            // Clear previous messages
            errorDiv.innerHTML = '';
            outputSection.classList.remove('active');

            if (!token) {
                errorDiv.innerHTML = '<div class="error">‚ùå Please enter a JWT token</div>';
                return;
            }

            try {
                // Split the token into parts
                const parts = token.split('.');

                if (parts.length !== 3) {
                    throw new Error('Invalid JWT format. A valid JWT should have 3 parts separated by dots.');
                }

                // Decode header and payload
                const header = JSON.parse(base64UrlDecode(parts[0]));
                const payload = JSON.parse(base64UrlDecode(parts[1]));
                const signature = parts[2];

                // // Display the decoded parts
                // document.getElementById('headerContent').textContent = formatJSON(header);
                // document.getElementById('payloadContent').textContent = formatJSON(payload);
                // document.getElementById('signatureContent').textContent = signature;

                // Create claims table
                document.getElementById('claimsTable').innerHTML = createClaimsTable(payload);

                // Show output section
                outputSection.classList.add('active');

                // Show success message
                errorDiv.innerHTML = '<div class="success">‚úÖ Token decoded successfully!</div>';

                // Scroll to output
                outputSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            } catch (error) {
                errorDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }

        function clearAll() {
            document.getElementById('jwtInput').value = '';
            document.getElementById('errorMessage').innerHTML = '';
            document.getElementById('outputSection').classList.remove('active');
        }

        function copyToClipboard(elementId) {
            const content = document.getElementById(elementId).textContent;
            
            navigator.clipboard.writeText(content).then(() => {
                // Create temporary success message
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ Copied!';
                button.style.background = '#27ae60';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '';
                }, 2000);
            }).catch(err => {
                alert('Failed to copy to clipboard');
            });
        }

        // Allow Enter key to decode (Ctrl+Enter in textarea)
        document.getElementById('jwtInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                decodeToken();
            }
        });
    </script>
</body>
</html>
